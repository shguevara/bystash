"use strict";var WPFormsConversationalForms=window.WPFormsConversationalForms||function(e,r,o){var l,a,t,i,d,c,n,s,f,h;return l={page:o("#wpforms-conversational-form-page"),form:o(".wpforms-form"),header:o(".wpforms-conversational-form-header"),phpErrorContainer:o(".wpforms-error-container"),fields:o(".wpforms-field-container .wpforms-field"),recaptchaContainer:o(".wpforms-recaptcha-container"),footer:o(".wpforms-submit-container"),progress:{bar:o(".wpforms-conversational-form-footer-progress-completed"),completed:o(".wpforms-conversational-form-footer-progress-status .completed"),totalCount:o(".wpforms-conversational-form-footer-progress-status .completed-of")}},a={string:{toCapitalizedCamelCase:function(e){return e&&"string"==typeof e?e.replace(/[\s-_](.)/g,function(e){return e.toUpperCase()}).replace(/[\s-_]/g,"").replace(/^(.)/,function(e){return e.toUpperCase()}):e}},object:{isEmpty:function(e){return"object"!=typeof e||!Object.keys(e).length},findSequentialKey:function(e,t,i){i=i||0;var n,s=Object.keys(e),r=s[s.indexOf(t.toString())+i];return r in e&&(n=e[r]),n},findNextKey:function(e,t){return a.object.findSequentialKey(e,t,1)},findPrevKey:function(e,t){return a.object.findSequentialKey(e,t,-1)},findFirstKey:function(e){return a.object.getKeyByNumIndex(e,0)},findLastKey:function(e){return a.object.getKeyByNumIndex(e,Object.keys(e).length-1)},getNumKeyIndex:function(e,t){return Object.keys(e).indexOf(t.toString())},getKeyByNumIndex:function(e,t){t=t||0;var i,n=Object.keys(e)[t];return n in e&&(i=e[n]),i}},class:{extend:function(t,e){var i=t.prototype;t.prototype=Object.create(e.prototype),Object.keys(i).forEach(function(e){t.prototype[e]=i[e]}),(t.prototype.constructor=t).superclass=e.prototype,e.prototype.constructor===Object.prototype.constructor&&(e.prototype.constructor=e)}}},t={baseline:(h=3,("ontouchstart"in r||0<r.navigator.maxTouchPoints)&&(h=5),r.innerHeight/h),isTop:function(){return 0===o(r).scrollTop()},top:function(){l.page.addClass("wpforms-conversational-form-start"),f.scroll.to(l.header)},start:function(){var e;for(l.page.removeClass("wpforms-conversational-form-start"),e=a.object.findFirstKey(f.fields.registered);e&&!e.$el.is(":visible");)e=a.object.findNextKey(f.fields.registered,e.id);e&&f.scroll.to(e)},finish:function(){f.fields.active?f.fields.active.validate()&&f.scroll.to(l.footer):f.scroll.to(l.footer)},next:function(){var e=f.fields.findNext();(e||!l.page.hasClass("wpforms-conversational-form-start"))&&(e||!f.fields.isAtBaseline(l.header))?!e&&f.fields.isAtBaseline(l.footer)||(e?f.fields.active.validate()&&f.scroll.to(e):f.scroll.finish()):f.scroll.start()},prev:function(){var e=f.fields.findPrev();if(e||!f.fields.isAtBaseline(l.header)){if(!e&&f.fields.isAtBaseline(l.footer))for(e=a.object.findLastKey(f.fields.registered);e&&!e.$el.is(":visible");)e=a.object.findPrevKey(f.fields.registered,e.id);e&&f.scroll.to(e)}},before:function(){o(r).off("scroll",f.scroll.passive),f.unmapAllGlobalEvents()},after:function(){f.mapAllGlobalEvents(),f.fields.callOnActive("activate"),o(r).on("scroll",f.scroll.passive),f.updateProgressBar()},animate:function(e){if(!e||!e.length)return o.Deferred().resolve();var t=e.offset().top-f.scroll.baseline+1;return f.scroll.before(),o("html, body").animate({scrollTop:t},350).promise().then(f.scroll.after)},to:function(e){var t=e.$el||e;if(t&&t.length)return f.fields.updateActive(e,!0),e instanceof d.Field&&e.items.current&&(t=e.items.current.$el),f.scroll.animate(t)},passive:function(){var e=o(r).scrollTop();if(f.fields.active||f.fields.updateActive(),0!==e)if(0<e&&l.page.hasClass("wpforms-conversational-form-start"))f.scroll.start();else if(f.fields.active){var t=f.fields.active.$el.offset().top-f.scroll.baseline;t+f.fields.active.$el.outerHeight(!0)<e&&f.fields.updateActive(f.fields.findNext()),e<t&&f.fields.updateActive(f.fields.findPrev()),setTimeout(function(){f.fields.active&&!f.fields.isAtBaseline(f.fields.active)&&f.fields.updateActive()},100)}}},i={obj:null,eventType:null,unmapDisabledEvents:function(){a.object.isEmpty(this.obj[this.eventType].disable)||o.each(this.obj[this.eventType].disable,function(e){if(void 0===this.obj[this.eventType].disable[e])return!0;this.obj[this.eventType].disable[e].$el.off(this.obj[this.eventType].disable[e].handler,this.obj[this.eventType].disable[e].fn)}.bind(this))},mapDisabledEvents:function(){a.object.isEmpty(this.obj[this.eventType].disable)||o.each(this.obj[this.eventType].disable,function(e){if(void 0===this.obj[this.eventType].disable[e])return!0;this.obj[this.eventType].disable[e].$el.on(this.obj[this.eventType].disable[e].handler,this.obj[this.eventType].disable[e].fn)}.bind(this))},mapEnabledEvents:function(){a.object.isEmpty(this.obj[this.eventType].enable)||o.each(this.obj[this.eventType].enable,function(e){if("undefined"===this.obj[this.eventType].active[e])return!0;this.obj[this.eventType].active[e]=this.obj[this.eventType].enable[e],this.obj[this.eventType].active[e].fn=this.obj[this.eventType].enable[e].fn.bind(this.obj),this.obj[this.eventType].active[e].$el.on(this.obj[this.eventType].active[e].handler,this.obj[this.eventType].active[e].fn)}.bind(this))},unmapEnabledEvents:function(){a.object.isEmpty(this.obj[this.eventType].active)||(o.each(this.obj[this.eventType].active,function(e){if("undefined"===this.obj[this.eventType].active[e])return!0;this.obj[this.eventType].active[e].$el.off(this.obj[this.eventType].active[e].handler,this.obj[this.eventType].active[e].fn)}.bind(this)),this.obj[this.eventType].active={})},mapEvents:function(e,t){e&&t&&t in e&&(this.obj=e,this.eventType=f.isMobileDevice()?t+"Mobile":t,a.object.isEmpty(this.obj[this.eventType])||(this.unmapDisabledEvents(),this.mapEnabledEvents()))},unmapEvents:function(e,t){e&&t&&t in e&&(this.obj=e,this.eventType=f.isMobileDevice()?t+"Mobile":t,a.object.isEmpty(this.obj[this.eventType])||(this.unmapEnabledEvents(),this.mapDisabledEvents()))}},d={FieldItem:function(){function e(e,t,i,n){this.$el=e,this.id=t,this.type=i,this.parentField=n,this.focusable=!1,this.highlighted=!1,this.keyboard={enable:{},disable:{},active:{}},this.events={enable:{},active:{}},this.keyboardMobile={enable:{},disable:{},active:{}},this.eventsMobile={enable:{},active:{}},this.vars={},this.init()}return e.prototype.mapEvents=function(){this.events.enable.clickActivate={$el:this.$el,handler:"mousedown",fn:function(e){if(this.parentField.items&&this.parentField.items.current&&void 0!==this.id&&this.id in this.parentField.items.registered&&this.id!==this.parentField.items.current.id){var t=this.parentField.items.registered[this.id];this.parentField.items.current.fadeOut(),this.parentField.items.setCurrent(t),f.scroll.animate(t.$el).then(t.fadeIn.bind(this))}}},this.eventsMobile.enable.clickActivate=this.events.enable.clickActivate,i.mapEvents(this,"events")},e.prototype.unmapEvents=function(){i.unmapEvents(this,"events")},e.prototype.isFocusable=function(){var e=this.$el.prop("tagName"),t=this.$el.prop("type");return"hidden"!==t&&("INPUT"===e&&["checkbox","radio"].indexOf(t)<0||("TEXTAREA"===e||"SELECT"===e))},e.prototype.focus=function(){this.focusable&&!f.isMobileDevice()&&this.$el.get(0).focus({preventScroll:!0}),i.mapEvents(this,"keyboard"),this.$el.trigger("wpformsConvFormsFieldItemFocus",this)},e.prototype.blur=function(){this.focusable&&this.$el.blur(),i.unmapEvents(this,"keyboard"),this.$el.trigger("wpformsConvFormsFieldItemBlur",this)},e.prototype.addHTML=function(){},e.prototype.removeHTML=function(){this.parentField.$el.find(".wpforms-conversational-field-item-additional-html").remove()},e.prototype.getHoverEl=function(){return this.$el},e.prototype.addHover=function(){var e=this.getHoverEl();e&&e.addClass("wpforms-field-item-hover")},e.prototype.removeHover=function(){var e=this.getHoverEl();e&&e.removeClass("wpforms-field-item-hover")},e.prototype.fadeIn=function(){this.highlighted||this.focusable||(this.highlighted=!0,this.addHover()),this.focus(),f.isMobileDevice()||this.addHTML()},e.prototype.fadeOut=function(){this.highlighted&&!this.focusable&&(this.highlighted=!1,this.removeHover()),this.blur(),f.isMobileDevice()||this.removeHTML()},e.prototype.getValidateEl=function(){return this.$el},e.prototype.validate=function(e,t){return void 0===o.fn.validate||(e||(e=l.form.data("validator")),!e||(!this.focusable&&!t||e.element(this.getValidateEl())))},e.prototype.init=function(){this.focusable=this.isFocusable()},e}(),FieldItemsSet:function(){function e(e){this.field=e,this.registered={},this.current=null}return e.prototype.findElements=function(){return this.field.$el.find("input, textarea, select")},e.prototype.identifyItemType=function(e){return!e&&this.current&&(e=this.current.$el),e?e.prop("type"):""},e.prototype.updateRegistered=function(){if(this.field.$el){var e=this.findElements();e.length&&e.each(function(e,t){var i=this.field.id+"-"+e,n=this.identifyItemType(o(t));if("hidden"===n)return!0;var s=a.string.toCapitalizedCamelCase(n),r=d.FieldItem;s in c.fieldItem&&(r=c.fieldItem[s]),f.isMobileDevice()&&"SelectOne"===s&&(r=c.fieldItem.SelectMobile),this.registered[i]=new r(o(t),i,n,this.field)}.bind(this))}},e.prototype.setCurrent=function(e){this.current&&this.current.fadeOut(),e?e instanceof d.FieldItem&&(this.current=e):this.current=null},e.prototype.setCurrentFirst=function(){var e=a.object.findFirstKey(this.registered);e&&this.setCurrent(e)},e.prototype.setCurrentLast=function(){var e=a.object.findLastKey(this.registered);e&&this.setCurrent(e)},e.prototype.initCurrent=function(){if(!this.current){var e=a.object.findFirstKey(this.registered);e&&this.setCurrent(e)}},e.prototype.selectCurrent=function(){this.current&&this.current instanceof d.FieldItem&&this.current.$el.trigger("click")},e.prototype.isCurrentHighlighted=function(){return!!this.current&&Boolean(this.current.highlighted)},e.prototype.findNext=function(){if(!this.current)return!1;for(var e=a.object.findNextKey(this.registered,this.current.id);e&&!e.$el.is(":visible");)e=a.object.findNextKey(this.registered,e.id);return e},e.prototype.findPrev=function(){if(!this.current)return!1;for(var e=a.object.findPrevKey(this.registered,this.current.id);e&&!e.$el.is(":visible");)e=a.object.findPrevKey(this.registered,e.id);return e},e.prototype.highlightNext=function(){var e=new o.Deferred;if(!this.current)return e.reject();if(!this.current.focusable&&!this.current.highlighted)return this.setCurrentFirst(),this.current.fadeIn(),e.resolve();var t=this.findNext();return t?this.current.validate()?(this.current.fadeOut(),this.current=t,this.current.focusable?f.scroll.animate(this.current.$el).then(function(){this.current.fadeIn(),e.resolve()}.bind(this)):(this.current.fadeIn(),e.resolve()),e):e.resolve():e.reject()},e.prototype.highlightPrev=function(){var e=new o.Deferred;if(!this.current)return e.reject();if(!this.current.focusable&&!this.current.highlighted)return this.setCurrentLast(),this.current.fadeIn(),e.resolve();var t=this.findPrev();return t?(this.current.fadeOut(),this.current=t,this.current.focusable?f.scroll.animate(this.current.$el).then(function(){this.current.fadeIn(),e.resolve()}.bind(this)):(this.current.fadeIn(),e.resolve()),e):e.reject()},e}(),Field:function(){function e(e,t){this.$el=e,this.id=t,this.type=null,this.items=null,this.keyboard={enable:{},disable:{},active:{}},this.events={enable:{},active:{}},this.keyboardMobile={enable:{},disable:{},active:{}},this.eventsMobile={enable:{},active:{}},this.vars={},this.init()}return e.prototype.mapEvents=function(){i.mapEvents(this,"keyboard"),i.mapEvents(this,"events"),o.each(this.items.registered,function(e,t){t.mapEvents()})},e.prototype.unmapEvents=function(){i.unmapEvents(this,"keyboard"),i.unmapEvents(this,"events"),o.each(this.items.registered,function(e,t){t.unmapEvents()})},e.prototype.focus=function(){this.items.current&&this.items.current.focus()},e.prototype.blur=function(){this.items.current&&this.items.current.fadeOut()},e.prototype.addHTML=function(){},e.prototype.removeHTML=function(){this.$el.find(".wpforms-conversational-field-additional-html").remove()},e.prototype.deactivate=function(){this.$el.removeClass("wpforms-conversational-form-field-active"),this.blur(),this.removeHTML(),this.unmapEvents()},e.prototype.activate=function(){this.$el.hasClass("wpforms-conversational-form-field-active")||(this.$el.trigger("wpformsConvFormsFieldActivationBefore",this),this.$el.addClass("wpforms-conversational-form-field-active"),this.mapEvents(),f.isMobileDevice()||this.addHTML(),this.focus(),this.$el.trigger("wpformsConvFormsFieldActivationAfter",this))},e.prototype.validate=function(){if(void 0===o.fn.validate)return!0;var i=l.form.data("validator");if(!i)return!0;var n=[];return o.each(this.items.registered,function(e,t){t.validate(i,!0)||n.push(e)}),this.$el.trigger("wpformsConvFormsFieldValidation",[n,this]),!n.length},e.prototype.getFieldItemsSetObj=function(){var e=a.string.toCapitalizedCamelCase(this.type);return new(e in c.fieldItemsSet?c.fieldItemsSet[e]:d.FieldItemsSet)(this)},e.prototype.init=function(){this.type=this.$el.data("field-type"),this.items=this.getFieldItemsSetObj(),this.items.updateRegistered(),this.items.initCurrent()},e}(),FieldsSet:function(){function e(){this.registered={},this.active=null}return e.prototype.updateRegistered=function(){l.fields.each(function(e,t){var i=o(t).data("field-id"),n=o(t).data("field-type");if(void 0===i||!n)return!0;if("hidden"===n)return!0;var s=i+"-"+n,r=a.string.toCapitalizedCamelCase(n);if("PaymentMultiple"===r&&(r="Radio"),-1!==["PaymentCheckbox","GdprCheckbox"].indexOf(r)&&(r="Checkbox"),r in c.field)return this.registered[s]=new c.field[r](o(t),s),!0;this.registered[s]=new d.Field(o(t),s)}.bind(this))},e.prototype.isAtBaseline=function(e){if(l.page.hasClass("wpforms-conversational-form-start"))return!1;var t=e;if(!t)return!1;if(e instanceof d.Field&&(t=e.$el),!t.is(":visible"))return!1;var i=o(r).scrollTop()+f.scroll.baseline,n=t.offset().top,s=n+t.outerHeight(!0);return n<=i&&i<=s},e.prototype.detectActive=function(){var i;return o.each(this.registered,function(e,t){if(this.isAtBaseline(t))return i=t,!1}.bind(this)),i},e.prototype.updateActive=function(e,t){this.clearActive(),(e=e||this.detectActive())&&e instanceof d.Field&&e.$el.length&&(this.active=e,t||e.activate()),t||f.updateProgressBar()},e.prototype.clearActive=function(){this.active&&this.active instanceof d.Field&&(this.active.deactivate(),this.active=null)},e.prototype.callOnActive=function(e){var t;if(this.active&&this.active instanceof d.Field&&(e in this.active&&(t=this.active),e in this.active.items&&(t=this.active.items),t&&t[e]instanceof Function))return t[e]()},e.prototype.findNext=function(){if(this.active){for(var e=a.object.findNextKey(this.registered,this.active.id);e&&!e.$el.is(":visible");)e=a.object.findNextKey(this.registered,e.id);return e}},e.prototype.findPrev=function(){if(this.active){for(var e=a.object.findPrevKey(this.registered,this.active.id);e&&!e.$el.is(":visible");)e=a.object.findPrevKey(this.registered,e.id);return e}},e.prototype.getVisible=function(){var i={};return o.each(this.registered,function(e,t){t.$el.is(":visible")&&(i[e]=t)}),i},e.prototype.getCompletedCount=function(e){var t;return this.isAtBaseline(l.header)?0:(e=e||this.getVisible(),this.isAtBaseline(l.footer)?Object.keys(e).length:(this.active&&(t=a.object.getNumKeyIndex(e,this.active.id)),void 0!==t&&"-1"!==t&&t++,t||0))},e.prototype.getCompletedPercent=function(e,t){var i;return this.isAtBaseline(l.header)?0:this.isAtBaseline(l.footer)?100:(e=e||this.getVisible(),void 0!==(t=t||this.getCompletedCount(e))&&"-1"!==t&&(i=Math.floor(100*t/Object.keys(e).length)),i||0)},e}()},c={fieldItem:{Checkbox:function(){function e(e,t,i,n){d.FieldItem.call(this,e,t,i,n)}return e.prototype.getHoverEl=function(){return this.$el.closest("li")},e}(),Radio:function(){function e(e,t,i,n){d.FieldItem.call(this,e,t,i,n),this.events.enable={change:{$el:this.$el,handler:"change",fn:f.scroll.next}},this.eventsMobile.enable={change:this.events.enable.change}}return e.prototype.getHoverEl=function(){var e;return-1!==["radio","payment-multiple"].indexOf(this.parentField.type)&&(e=this.$el.closest("li")),"rating"===this.parentField.type&&(e=this.$el.parent("label")),"net_promoter_score"===this.parentField.type&&(e=this.$el.siblings("label")),e},e}(),SelectOne:function(){function e(e,t,i,n){this.elements={},d.FieldItem.call(this,e,t,i,n),this.keyboard.disable={up:f.globalEvents.keyboard.up,down:f.globalEvents.keyboard.down,enter:f.globalEvents.keyboard.enter,space:f.globalEvents.keyboard.space},this.keyboard.enable={up:{$el:o(r),handler:"keydown",fn:function(e){if(38===e.keyCode)if(this.dropdownIsOpened()){e.preventDefault();var t,i=this.elements.$items.filter(":visible"),n=i.filter(function(){return o(this).hasClass("selected")});i.removeClass("selected"),n.length||(t=i.last().addClass("selected")),t||(t=n.prevAll(".wpforms-conversational-form-dropdown-item:visible")),t.length||(t=i.last()),this.scrollItemIntoView(t),t.first().addClass("selected")}else try{f.fields.active.items.highlightPrev().fail(f.scroll.prev)}catch(e){f.scroll.prev()}}},down:{$el:o(r),handler:"keydown",fn:function(e){if(40===e.keyCode)if(e.preventDefault(),this.dropdownIsOpened()){var t,i=this.elements.$items.filter(":visible"),n=i.filter(function(){return o(this).hasClass("selected")});i.removeClass("selected"),n.length||(t=i.first().addClass("selected")),t||(t=n.nextAll(".wpforms-conversational-form-dropdown-item:visible")),t.length||(t=i.first()),this.scrollItemIntoView(t),t.first().addClass("selected")}else this.dropdownOpen(!0)}},enter:{$el:o(r),handler:"keydown",fn:function(e){if(13===e.keyCode)if(e.preventDefault(),this.dropdownIsOpened()){var t=this.elements.$items.filter(".selected:visible");t&&t.length||(t=this.elements.$items.filter(":visible")),t&&t.length?t.first().trigger("click"):this.dropdownClose()}else f.scroll.next()}},esc:{$el:o(r),handler:"keydown",fn:function(e){27===e.keyCode&&this.dropdownClose()}}},this.events.enable={keyboardInput:{$el:this.$el,handler:"keyup",fn:function(e){-1===[13,27,38,40].indexOf(e.keyCode)&&this.dropdownOpen()}},optionClick:{$el:this.elements.$items,handler:"click",fn:function(e){var i=o(e.target).data("value"),t=this.elements.$options.filter(function(e,t){return o(t).val().toString()===i.toString()});t.length&&(this.$el.val(t.first().text()),this.elements.$select.val(t.first().val()).trigger("change"),this.elements.$selected=t.first()),this.dropdownClose();try{f.fields.active.items.highlightNext().fail(f.scroll.next)}catch(e){f.scroll.next()}}},chevronClick:{$el:this.$el.siblings(".fa-chevron-down"),handler:"click",fn:function(){this.dropdownIsOpened()?this.dropdownClose():this.dropdownOpen(!0)}},blur:{$el:this.$el,handler:"wpformsConvFormsFieldItemBlur",fn:function(){this.dropdownClose()}}}}return e.prototype.getValidateEl=function(){return this.elements.$select},e.prototype.init=function(){this.dropdownInit(),this.$el=this.elements.$container.find(".wpforms-conversational-form-dropdown-input input"),this.dropdownPopulateInitialValue(),this.type="select-input",this.focusable=this.isFocusable()},e.prototype.dropdownInit=function(){this.$el.wrap(o("<div></div>").addClass("wpforms-conversational-select").addClass(this.$el.attr("disabled")?"disabled":"")).before('<div class="wpforms-conversational-form-dropdown-input"><input type="text" class="wpforms-field-medium"><i class="fa fa-chevron-down"></i></div><div class="wpforms-conversational-form-dropdown-list-empty">'+wpforms_conversational_forms.i18n.select_list_empty+'</div><ul class="wpforms-conversational-form-dropdown-list"></ul><div class="wpforms-conversational-form-dropdown-list-helper">'+wpforms_conversational_forms.i18n.select_option_helper+"</div>").css({height:0,width:0,padding:0,border:0,display:"block"}),this.$el.find("[selected]").length||this.$el.prepend('<option value="" class="placeholder" disabled selected="selected">'+wpforms_conversational_forms.i18n.select_placeholder+"</option>"),this.elements={$select:this.$el,$container:this.$el.parent(".wpforms-conversational-select"),$options:this.$el.find("option"),$selected:this.$el.find("option:selected")},this.elements.$itemList=this.elements.$container.find(".wpforms-conversational-form-dropdown-list"),this.elements.$listEmpty=this.elements.$container.find(".wpforms-conversational-form-dropdown-list-empty").hide(),this.elements.$listHelper=this.elements.$container.find(".wpforms-conversational-form-dropdown-list-helper").hide(),this.elements.$options.each(function(e,t){var i=o(t);if(i.hasClass("placeholder"))return!0;this.elements.$container.find("ul").append(o("<li></li>").attr("data-value",i.val()).addClass("wpforms-conversational-form-dropdown-item").addClass("option"+(i.is(":selected")?" selected":"")+(i.is(":disabled")?" disabled":"")).html(i.text()))}.bind(this)),this.elements.$items=this.elements.$itemList.find(".wpforms-conversational-form-dropdown-item")},e.prototype.dropdownPopulateInitialValue=function(){this.elements.$selected.hasClass("placeholder")?this.$el.attr("placeholder",this.elements.$selected.text()):this.$el.val(this.elements.$selected.text())},e.prototype.dropdownFilter=function(e){try{var i=new RegExp(e,"gi")}catch(e){return!1}return this.elements.$items.filter(function(e,t){return o(t).text().match(i)})},e.prototype.dropdownOpen=function(e){var t,i=this.$el.val();if(this.elements.$listEmpty.hide(),this.elements.$items.hide(),!(t=!e&&i?this.dropdownFilter(i):this.elements.$items).length)return this.elements.$itemList.addClass("opened"),this.elements.$listHelper.hide(),void this.elements.$listEmpty.show();t.show(),this.elements.$listHelper.show(),this.elements.$itemList.addClass("opened"),this.elements.$items.removeClass("selected"),t.first().addClass("selected"),this.elements.$itemList.scrollTop(0),o("body").css("overflow","hidden"),o("#wpforms-conversational-form-page").css("paddingRight","15px")},e.prototype.dropdownClose=function(){var i=this.$el.val();if(this.elements.$listHelper.hide(),this.elements.$listEmpty.hide(),i){var e=this.elements.$options.filter(function(e,t){return o(t).text()===i});e.length?(this.elements.$select.val(e.first().val()),this.elements.$selected=e.first()):(this.$el.val(""),this.dropdownPopulateInitialValue())}else this.dropdownPopulateInitialValue();this.elements.$itemList.hide().removeClass("opened"),o("body").css("overflow","auto"),o("#wpforms-conversational-form-page").css("paddingRight","initial"),setTimeout(function(){this.elements.$itemList.show()}.bind(this),250)},e.prototype.dropdownIsOpened=function(){return!(!this.elements.$itemList||!this.elements.$itemList.length)&&this.elements.$itemList.hasClass("opened")},e.prototype.scrollItemIntoView=function(e){if((e=e.first())&&e.length){var t=this.elements.$itemList.height(),i=this.elements.$itemList.scrollTop(),n=parseInt(this.elements.$itemList.css("padding-top"),10),s=e.outerHeight(),r=e.position().top,o=i+r;r<0&&this.elements.$itemList.scrollTop(o-n),t<r+s&&this.elements.$itemList.scrollTop(o-(t-s))}},e}(),SelectMobile:function(e,t,i,n){d.FieldItem.call(this,e,t,i,n),this.eventsMobile.enable={change:{$el:this.$el,handler:"change",fn:function(){try{f.fields.active.items.highlightNext().fail(f.scroll.next)}catch(e){f.scroll.next()}}}}},Url:function(){function e(e,t,i,n){d.FieldItem.call(this,e,t,i,n)}return e.prototype.getValidateEl=function(){return this.$el.trigger("change"),this.$el},e}(),Date:function(){function e(e,t,i,n){d.FieldItem.call(this,e,t,i,n),this.$el.attr("data-rule-wpforms-conversational-forms-date","true"),this.loadInputMask()}return e.prototype.loadInputMask=function(){if(void 0!==o.fn.inputmask){var e;switch(this.$el.data("date-format")){case"d/m/Y":e="dd/mm/yyyy";break;default:e="mm/dd/yyyy"}var t=Object.create(null);o.extend(t,{alias:"datetime",inputFormat:e}),this.$el.inputmask(t)}},e}(),Time:function(){function e(e,t,i,n){d.FieldItem.call(this,e,t,i,n),this.loadInputMask()}return e.prototype.loadInputMask=function(){if(void 0!==o.fn.inputmask){var e;switch(this.$el.data("time-format")){case"H:i":e="HH:MM";break;default:e="hh:MM TT"}var t=Object.create(null);o.extend(t,{alias:"datetime",inputFormat:e,placeholder:"_"}),this.$el.inputmask(t)}},e}(),LikertRow:function(){function e(e,t,i,n){d.FieldItem.call(this,e,t,i,n)}return e.prototype.validate=function(e){return void 0===o.fn.validate||(e||(e=l.form.data("validator")),!e||e.element(this.getValidateEl()))},e.prototype.addHTML=function(){if(1!==Object.keys(this.parentField.items.registered).length){var e=this.$el.find("td").length+1;this.$el.after('<tr class="wpforms-conversational-field-item-additional-html"><td colspan="'+e+'">'+wpforms_conversational_forms.html.likert_scale+"</td></tr>")}},e.prototype.getValidateEl=function(){return this.$el.find("input")},e}(),RecaptchaHidden:function(e,t,i,n){d.FieldItem.call(this,e,t,i,n),this.events.enable={keyboardInput:{$el:this.$el,handler:"change",fn:function(){"1"===this.$el.val()&&f.scroll.to(l.footer).then(function(){l.footer.find(".wpforms-submit").focus()})}}},this.eventsMobile.enable={keyboardInput:this.events.enable.keyboardInput}}},fieldItemsSet:{DateTime:function(){function e(e){d.FieldItemsSet.call(this,e)}return e.prototype.identifyItemType=function(e){if(!e&&this.current&&(e=this.current.$el),!e)return"";var t=e.prop("type");return e.hasClass("wpforms-field-date-time-date")&&(t="date"),e.hasClass("wpforms-field-date-time-time")&&(t="time"),t},e}(),Signature:function(){function e(e){d.FieldItemsSet.call(this,e)}return e.prototype.findElements=function(){return[]},e}(),LikertScale:function(){function e(e){d.FieldItemsSet.call(this,e)}return e.prototype.findElements=function(){return this.field.$el.find("tbody tr")},e.prototype.identifyItemType=function(){return"likert_row"},e}(),Recaptcha:function(){function e(e){d.FieldItemsSet.call(this,e)}return e.prototype.findElements=function(){return this.field.$el.find(".wpforms-recaptcha-hidden")},e.prototype.identifyItemType=function(){return"recaptcha-hidden"},e}()},field:{Textarea:function(){function e(e,t){d.Field.call(this,e,t),this.keyboard.disable={up:f.globalEvents.keyboard.up,down:f.globalEvents.keyboard.down},this.keyboard.enable={up:{$el:o(r),handler:"keydown",fn:function(e){38===e.keyCode&&0===o(e.target).prop("selectionStart")&&f.scroll.prev()}},down:{$el:o(r),handler:"keydown",fn:function(e){40===e.keyCode&&o(e.target).val().length===o(e.target).prop("selectionStart")&&f.scroll.next()}}},this.events.enable={userInput:{$el:this.$el.find("textarea"),handler:"input paste",fn:function(){var e=this.$el.find("textarea"),t=e.innerHeight()-e.height();e.innerHeight<e.get(0).scrollHeight||e.height(1),e.height(e.get(0).scrollHeight-t)}}},this.eventsMobile.enable={userInput:this.events.enable.userInput}}return e.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.textarea+"</div>")},e}(),Checkbox:function(){function e(e,t){d.Field.call(this,e,t),this.keyboard.disable={enter:f.globalEvents.keyboard.enter},this.keyboard.enable={alphabet:{$el:o(r),handler:"keydown",fn:function(e){var t=this.$el.find('input[type="checkbox"]'),i=e.keyCode-65;t[i]&&o(t[i]).trigger("click")}},enter:{$el:o(r),handler:"keydown",fn:function(e){13!==e.keyCode||e.shiftKey||(e.preventDefault(),f.fields.callOnActive("isCurrentHighlighted")&&f.fields.active.items.selectCurrent())}},shiftEnter:{$el:o(r),handler:"keydown",fn:function(e){13===e.keyCode&&e.shiftKey&&(e.preventDefault(),f.scroll.next())}}}}return e.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.checkbox+"</div>")},e}(),Radio:function(e,t){d.Field.call(this,e,t),this.keyboard.enable={alphabet:{$el:o(r),handler:"keydown",fn:function(e){var t=this.$el.find('input[type="radio"]'),i=e.keyCode-65;t[i]&&o(t[i]).trigger("click")}}}},FileUpload:function(){function e(e,t){d.Field.call(this,e,t),this.keyboard.enable={shiftEnter:{$el:o(r),handler:"keydown",fn:function(e){13===e.keyCode&&e.shiftKey&&(e.preventDefault(),this.$el.find("input").trigger("click"),this.$el.find(".wpforms-uploader").trigger("click"))}}},this.events.enable={changeFile:{$el:this.$el.find('input[type="file"]'),handler:"change",fn:function(e){var t=this.$el.find('input[type="file"]').get(0);if(t.files&&1===t.files.length){var i=e.target.value.split("\\").pop();i&&(o(t).nextAll(".wpforms-field-file-upload-file-name").text(i),f.scroll.next())}}}},this.eventsMobile.enable={changeFile:this.events.enable.changeFile}}return e.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.file_upload+"</div>")},e}(),Rating:function(e,t){d.Field.call(this,e,t),this.keyboard.disable={up:f.globalEvents.keyboard.up,down:f.globalEvents.keyboard.down},this.keyboard.enable={numeric:{$el:o(r),handler:"keydown",fn:function(e){var t=this.items.registered;if(e.keyCode){var i=String.fromCharCode(e.keyCode);if(!isNaN(parseInt(i,10))){this.vars.keyBuffer=this.vars.keyBuffer||"",this.vars.keyBuffer+=i;var n=a.object.getKeyByNumIndex(t,parseInt(this.vars.keyBuffer,10)-1);n||(n=a.object.getKeyByNumIndex(t,parseInt(i,10)-1)),n&&(this.vars.timer&&clearTimeout(this.vars.timer),this.vars.timer=setTimeout(function(){delete this.vars.keyBuffer,delete this.vars.timer,n.$el.trigger("click")}.bind(this),250))}}}},up:{$el:o(r),handler:"keydown",fn:function(e){38===e.keyCode&&(e.preventDefault(),f.scroll.prev())}},down:{$el:o(r),handler:"keydown",fn:function(e){40===e.keyCode&&(e.preventDefault(),f.scroll.next())}}}},NetPromoterScore:function(e,t){d.Field.call(this,e,t),this.keyboard.disable={up:f.globalEvents.keyboard.up,down:f.globalEvents.keyboard.down},this.keyboard.enable={numeric:{$el:o(r),handler:"keydown",fn:function(e){var t=this.items.registered;if(e.keyCode){var i=String.fromCharCode(e.keyCode);if(!isNaN(parseInt(i,10))){this.vars.keyBuffer=this.vars.keyBuffer||"",this.vars.keyBuffer+=i;var n=a.object.getKeyByNumIndex(t,this.vars.keyBuffer);n||(n=a.object.getKeyByNumIndex(t,i)),n&&(this.vars.timer&&clearTimeout(this.vars.timer),this.vars.timer=setTimeout(function(){delete this.vars.keyBuffer,delete this.vars.timer,n.$el.trigger("click")}.bind(this),250))}}}},up:{$el:o(r),handler:"keydown",fn:function(e){38===e.keyCode&&(e.preventDefault(),f.scroll.prev())}},down:{$el:o(r),handler:"keydown",fn:function(e){40===e.keyCode&&(e.preventDefault(),f.scroll.next())}}}},LikertScale:function(e,t){d.Field.call(this,e,t),this.keyboard.disable={enter:f.globalEvents.keyboard.enter,left:f.globalEvents.keyboard.left,right:f.globalEvents.keyboard.right},this.keyboard.enable={numeric:{$el:o(r),handler:"keydown",fn:function(e){if(this.items.current){var t=this.items.current.$el.find("input"),i=e.keyCode-49;t[i]&&o(t[i]).siblings("label").trigger("click")}}},enter:{$el:o(r),handler:"keydown",fn:function(e){13!==e.keyCode||e.shiftKey||(e.preventDefault(),f.scroll.next())}},left:{$el:o(r),handler:"keydown",fn:function(e){37===e.keyCode&&e.preventDefault()}},right:{$el:o(r),handler:"keydown",fn:function(e){39===e.keyCode&&e.preventDefault()}}},this.events.enable={activateFirstRow:{$el:this.$el,handler:"wpformsConvFormsFieldActivationAfter",fn:function(){this.items.highlightNext()}},validation:{$el:this.$el,handler:"wpformsConvFormsFieldValidation",fn:function(e,t){t.length&&t[0]in this.items.registered&&(this.items.setCurrent(this.items.registered[t[0]]),this.items.current.fadeIn())}}},this.eventsMobile.enable={validation:this.events.enable.validation}},Html:function(){function e(e,t){d.Field.call(this,e,t)}return e.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.general.next_field+"</div>")},e}(),Divider:function(){function e(e,t){d.Field.call(this,e,t)}return e.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.general.next_field+"</div>")},e}(),PaymentSingle:function(){function e(e,t){d.Field.call(this,e,t)}return e.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.general.next_field+"</div>")},e}(),PaymentTotal:function(){function e(e,t){d.Field.call(this,e,t)}return e.prototype.addHTML=function(){this.$el.append('<div class="wpforms-conversational-field-additional-html">'+wpforms_conversational_forms.html.general.next_field+"</div>")},e}()}},n={keyboard:{enter:{$el:o(r),handler:"keydown",fn:function(e){if(13===e.keyCode&&!e.shiftKey){if(e.preventDefault(),f.fields.isAtBaseline(l.footer))return void l.footer.find(".wpforms-submit").trigger("click");if(f.fields.callOnActive("isCurrentHighlighted"))return void f.fields.active.items.selectCurrent();f.scroll.next()}}},space:{$el:o(r),handler:"keydown",fn:function(e){if(32===e.keyCode){if(f.fields.active.items.current.focusable)return;e.preventDefault(),f.fields.callOnActive("isCurrentHighlighted")&&f.fields.active.items.selectCurrent()}}},tab:{$el:o(r),handler:"keydown",fn:function(e){if(9===e.keyCode&&!e.shiftKey){e.preventDefault();try{f.fields.active.items.highlightNext().fail(f.scroll.next)}catch(e){f.scroll.next()}}if(9===e.keyCode&&e.shiftKey){e.preventDefault();try{f.fields.active.items.highlightPrev().fail(f.scroll.prev)}catch(e){f.scroll.prev()}}}},esc:{$el:o(r),handler:"keydown",fn:function(e){27===e.keyCode&&f.fields.callOnActive("isCurrentHighlighted")&&(f.fields.active.items.setCurrent(),f.fields.active.items.initCurrent())}},up:{$el:o(r),handler:"keydown",fn:function(e){if(38===e.keyCode){e.preventDefault();try{f.fields.active.items.highlightPrev().fail(f.scroll.prev)}catch(e){f.scroll.prev()}}}},down:{$el:o(r),handler:"keydown",fn:function(e){if(40===e.keyCode){e.preventDefault();try{f.fields.active.items.highlightNext().fail(f.scroll.next)}catch(e){f.scroll.next()}}}},left:{$el:o(r),handler:"keydown",fn:function(e){if(37===e.keyCode){if(f.fields.active.items.current.focusable)return;e.preventDefault(),f.fields.callOnActive("highlightPrev")}}},right:{$el:o(r),handler:"keydown",fn:function(e){if(39===e.keyCode){if(f.fields.active.items.current.focusable)return;e.preventDefault(),f.fields.callOnActive("highlightNext")}}}},events:{clickActivateField:{$el:l.fields,handler:"mousedown",fn:function(e){var t=f.fields.active?f.fields.active.id:null,i=o(this).data("field-id")+"-"+o(this).data("field-type");void 0!==i&&i in f.fields.registered&&i!==t&&(e.preventDefault(),f.scroll.to(f.fields.registered[i]))}}}},s={keyboard:{enter:{$el:o(r),handler:"keydown",fn:function(e){if(13===e.keyCode){e.preventDefault();try{f.fields.active.items.highlightNext().fail(f.scroll.next)}catch(e){f.scroll.next()}}}}},events:{clickActivateField:n.events.clickActivateField}},f={fields:null,scroll:t,globalEvents:null,mobileDetect:null,init:function(){f.extendClasses(),this.fields=new d.FieldsSet,"undefined"!=typeof MobileDetect&&(f.mobileDetect=new MobileDetect(r.navigator.userAgent)),this.globalEvents=f.isMobileDevice()?s:n,o(e).ready(f.ready)},ready:function(){f.hidePreloader(),f.readyToStart()?(f.setup(),f.events()):f.runNotReadyActions()},isMobileDevice:function(){return!!f.mobileDetect&&!!f.mobileDetect.mobile()},extendClasses:function(){o.each(c,function(i,e){o.each(e,function(e,t){a.class.extend(t,d[a.string.toCapitalizedCamelCase(i)])})})},hidePreloader:function(){o("html").removeClass("wpforms-conversational-form-loading")},readyToStart:function(){return!o(".wpforms-confirmation-container").length&&!o(".wpforms-confirmation-container-full").length},runNotReadyActions:function(){o(".wpforms-conversational-form-footer-progress-status-proportion").hide(),o(".wpforms-conversational-form-footer-progress-status-proportion-completed").show(),o(".wpforms-conversational-form-footer-switch-step").hide()},setup:function(){f.addRecaptchaToRegisteredFields(),f.fields.updateRegistered(),f.loadValidation(),f.mapAllGlobalEvents(),f.runInitialActions(),f.fields.updateActive()},events:function(){o(r).on("scroll",f.scroll.passive),o(".wpforms-conversational-btn-start").click(f.scroll.next),o(".wpforms-conversational-form-footer-switch-step-up").click(f.footerStepUpBtnAction),o(".wpforms-conversational-form-footer-switch-step-down").click(f.footerStepDownBtnAction),o(e).on("wpformsProcessConditionalsField",f.updateProgressBar)},addRecaptchaToRegisteredFields:function(){if(l.recaptchaContainer.length){var e=l.recaptchaContainer.find(".g-recaptcha");e.length&&"invisible"!==e.data("size")&&(l.recaptchaContainer.attr("data-field-type","recaptcha").attr("data-field-id","g"),l.fields=l.fields.add(l.recaptchaContainer))}},loadValidation:function(){void 0!==o.fn.validate&&setTimeout(function(){var e=l.form.data("validator");e&&(o.validator.addMethod("wpforms-conversational-forms-date",function(e,t){return this.optional(t)||/^\d{1,2}\/\d{2}\/\d{4}$/.test(e)},o.validator.messages.date),e.settings.focusInvalid=!1,e.settings.ignore=":hidden, .wpforms-conversational-form-dropdown-input input",e.settings.invalidHandler=function(e,t){if(t.numberOfInvalids()&&t.errorList.length){var i=o(t.errorList[0].element).closest(".wpforms-field").data("field-id"),n=o(t.errorList[0].element).closest(".wpforms-field").data("field-type");i+"-"+n in f.fields.registered&&f.scroll.to(f.fields.registered[i+"-"+n])}},l.form.on("invalid-form.validate",e.settings.invalidHandler))},0)},mapAllGlobalEvents:function(){o.each(f.globalEvents.events,function(e){f.globalEvents.events[e].$el.on(f.globalEvents.events[e].handler,f.globalEvents.events[e].fn)}),o.each(f.globalEvents.keyboard,function(e){f.globalEvents.keyboard[e].$el.on(f.globalEvents.keyboard[e].handler,f.globalEvents.keyboard[e].fn)})},unmapAllGlobalEvents:function(){o.each(f.globalEvents.events,function(e){f.globalEvents.events[e].$el.off(f.globalEvents.events[e].handler,f.globalEvents.events[e].fn)}),o.each(f.globalEvents.keyboard,function(e){f.globalEvents.keyboard[e].$el.off(f.globalEvents.keyboard[e].handler,f.globalEvents.keyboard[e].fn)})},runInitialActions:function(){f.scroll.isTop()&&!l.phpErrorContainer.length&&l.page.addClass("wpforms-conversational-form-start"),l.phpErrorContainer.length&&f.scroll.to(l.phpErrorContainer)},updateProgressBar:function(){l.progress.totalCount.length?f.updateProportionProgressBar():f.updatePercentageProgressBar()},updateProportionProgressBar:function(){var e=f.fields.getVisible(),t=Object.keys(e).length,i=f.fields.isAtBaseline(l.footer)?t:f.fields.getCompletedCount(e),n=f.fields.getCompletedPercent(e,i);l.progress.bar.width(n+"%"),l.progress.completed.text(i),l.progress.totalCount.text(t)},updatePercentageProgressBar:function(){var e=f.fields.getCompletedPercent();l.progress.bar.width(e+"%"),l.progress.completed.text(e)},footerStepUpBtnAction:function(){var e=f.fields.callOnActive("identifyItemType");if(-1===["checkbox","radio"].indexOf(e))try{f.fields.active.items.highlightPrev().fail(f.scroll.prev)}catch(e){f.scroll.prev()}else f.scroll.prev()},footerStepDownBtnAction:function(){var e=f.fields.callOnActive("identifyItemType");if(-1===["checkbox","radio"].indexOf(e))try{f.fields.active.items.highlightNext().fail(f.scroll.next)}catch(e){f.scroll.next()}else f.scroll.next()}}}(document,window,jQuery);WPFormsConversationalForms.init();