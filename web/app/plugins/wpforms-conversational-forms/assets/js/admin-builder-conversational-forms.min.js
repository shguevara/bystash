"use strict";var WPFormsBuilderConversationalForms=window.WPFormsBuilderConversationalForms||function(e,n,o){var t={toggleSettingsCheckbox:o("#wpforms-panel-field-settings-conversational_forms_enable"),previewFormBtn:o("#wpforms-conversational-forms-preview-conversational-form"),slug:{textField:o("#wpforms-panel-field-settings-conversational_forms_page_slug"),editBtn:o(".wpforms-conversational-forms-page-slug-edit"),viewBtn:o(".wpforms-conversational-forms-page-slug-view"),cancelBtn:o(".wpforms-conversational-forms-page-slug-cancel")},logo:{previewContainer:o(".wpforms-conversational-forms-custom-logo-container"),textField:o("#wpforms-panel-field-settings-conversational_forms_custom_logo"),addBtn:o(".wpforms-conversational-forms-custom-logo-upload"),deleleBtn:o(".wpforms-conversational-forms-custom-logo-delete")}},i={settings:{minicolorsChangeDelay:750,minicolorsInputEventRunLength:6},init:function(){o(e).ready(i.ready)},ready:function(){i.conditionals(),i.events(),i.actions()},conditionals:function(){void 0!==o.fn.conditions&&t.toggleSettingsCheckbox.conditions({conditions:{element:"#wpforms-panel-field-settings-conversational_forms_enable",type:"checked",operator:"is"},actions:{if:{element:"#wpforms-conversational-forms-content-block,#wpforms-conversational-forms-preview-conversational-form",action:"show"},else:{element:"#wpforms-conversational-forms-content-block,#wpforms-conversational-forms-preview-conversational-form",action:"hide"}},effect:"appear"})},events:function(){i.generalEvents(),i.colorPickerEvents(),i.customLogoEvents(),i.formSlugEvents()},actions:function(){i.prefillPageTitle()},generalEvents:function(){t.toggleSettingsCheckbox.click(function(e){i.toggleSettingsPanel(e)})},colorPickerEvents:function(){o.minicolors.defaults.changeDelay=i.settings.minicolorsChangeDelay,o("#wpforms-panel-field-settings-conversational_forms_color_scheme-7").minicolors({show:function(){o(this).prop("checked",!0)},change:function(e){e&&o("#wpforms-panel-field-settings-conversational_forms_color-input").val(e)}}),o("#wpforms-panel-field-settings-conversational_forms_color_scheme-wrap .minicolors-panel").append('<input type="text" id="wpforms-panel-field-settings-conversational_forms_color-input" class="minicolors-input-inner">'),o(e).on("input","#wpforms-panel-field-settings-conversational_forms_color-input",function(e){e.target.value.length>=i.settings.minicolorsInputEventRunLength&&o("#wpforms-panel-field-settings-conversational_forms_color_scheme-7").minicolors("value",e.target.value)})},customLogoEvents:function(){t.logo.addBtn.click(function(e){e.preventDefault(),i.openMediaFrame()}),t.logo.deleleBtn.click(function(e){e.preventDefault(),i.deleteCustomLogo()})},formSlugEvents:function(){t.previewFormBtn.click(function(e){i.previewForm(e)}),t.slug.viewBtn.click(function(e){i.previewForm(e)}),o("#wpforms-builder").on("wpformsSaved",function(e,o){i.updateFormSlugUI(o)})},toggleSettingsPanel:function(e){t.toggleSettingsCheckbox.is(":checked")&&o("#wpforms-panel-field-settings-form_pages_enable").is(":checked")&&(e.preventDefault(),o.confirm({title:!1,content:wpforms_admin_builder_conversational_forms.i18n.enable_prevent_modal,closeIcon:!1,icon:"fa fa-exclamation-circle",type:"orange",buttons:{cancel:{text:wpforms_admin_builder_conversational_forms.i18n.enable_prevent_modal_ok}}}))},previewForm:function(e){if(e.preventDefault(),WPFormsBuilder.formIsSaved())n.open(e.target.href,"_blank");else{var o=n.open("","_blank");WPFormsBuilder.formSave().done(function(){o.location=e.target.href})}},initMediaFrame:function(){var e,o={title:wpforms_admin_builder_conversational_forms.i18n.logo_selection_frame_title,button:{text:wpforms_admin_builder_conversational_forms.i18n.logo_selection_frame_button_text},library:{type:"image"},multiple:!1};return(e=wp.media(o)).on("select",function(){i.selectCustomLogo(e)}),e},openMediaFrame:function(){(void 0===wp.media.frame?i.initMediaFrame():wp.media.frame).open()},selectCustomLogo:function(e){var o=e.state().get("selection").first().toJSON(),n=o.url;void 0!==o.sizes.medium&&(n=o.sizes.medium.url),t.logo.deleleBtn.find("img").remove(),t.logo.deleleBtn.append('<img src="'+n+'" alt="'+wpforms_admin_builder_conversational_forms.i18n.logo_preview_alt+'"/>'),t.logo.previewContainer.show(),t.logo.textField.val(o.id),t.logo.deleleBtn.show()},deleteCustomLogo:function(){t.logo.previewContainer.find("img").remove(),t.logo.addBtn.show(),t.logo.previewContainer.hide(),t.logo.textField.val("")},updateFormSlugUI:function(e){void 0!==e.conversational_forms&&(t.slug.textField.val(e.conversational_forms.slug),t.slug.viewBtn.prop("href",e.conversational_forms.url),t.previewFormBtn.prop("href",e.conversational_forms.url))},prefillPageTitle:function(){var e;wpf.getQueryString("newform")&&((e=o("#wpforms-panel-field-settings-conversational_forms_title")).val()||e.val(o("#wpforms-panel-field-settings-form_title").val()))}};return i}(document,window,jQuery);WPFormsBuilderConversationalForms.init();